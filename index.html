<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Pricing Calculator</title>
</head>
<body>
    <h1>API Pricing Calculator</h1>
    <form id="pricingForm">
        <label for="inputTokens">Input Tokens:</label>
        <input type="number" id="inputTokens" name="inputTokens"><br><br>

        <label for="outputTokens">Output Tokens:</label>
        <input type="number" id="outputTokens" name="outputTokens"><br><br>

        <label for="width">Image Width:</label>
        <input type="number" id="width" name="width" value="4096"><br><br>

        <label for="height">Image Height:</label>
        <input type="number" id="height" name="height" value="4096"><br><br>

        <label for="detail">Detail Level:</label>
        <select id="detail" name="detail">
            <option value="low">Low</option>
            <option value="high">High</option>
            <option value="auto">Auto</option>
        </select><br><br>

        <button type="button" onclick="calculateCosts()">Calculate</button>
    </form>

    <h2>Results</h2>
    <p id="standardCost">Standard Pricing Cost: </p>
    <p id="batchCost">Batch API Pricing Cost: </p>
    <p id="visionCost">Vision Pricing Cost: </p>

    <script>
        function calculateStandardPricing(inputTokens, outputTokens) {
            const inputCost = (inputTokens / 1_000_000) * 0.15;
            const outputCost = (outputTokens / 1_000_000) * 0.60;
            return inputCost + outputCost;
        }

        function calculateBatchPricing(inputTokens, outputTokens) {
            const inputCost = (inputTokens / 1_000_000) * 0.075;
            const outputCost = (outputTokens / 1_000_000) * 0.30;
            return inputCost + outputCost;
        }

        function calculateVisionPricing(width, height, detail) {
            const baseTokens = 85;
            let totalTokens = baseTokens;

            if (detail === "low") {
                return (totalTokens / 1_000_000) * 0.15;
            }

            // For high and auto detail
            const maxSize = 2048;
            const scaledWidth = width > maxSize ? (maxSize / width) * width : width;
            const scaledHeight = height > maxSize ? (maxSize / height) * height : height;

            const shortSide = Math.min(scaledWidth, scaledHeight);
            const longSide = Math.max(scaledWidth, scaledHeight);

            const finalWidth = shortSide < 768 ? (768 / shortSide) * shortSide : shortSide;
            const finalHeight = shortSide < 768 ? (768 / shortSide) * longSide : longSide;

            const tiles = Math.ceil(finalWidth / 512) * Math.ceil(finalHeight / 512);
            totalTokens += tiles * 170;

            return (totalTokens / 1_000_000) * 0.15;
        }

        function calculateCosts() {
            const inputTokens = parseInt(document.getElementById('inputTokens').value);
            const outputTokens = parseInt(document.getElementById('outputTokens').value);
            const width = parseInt(document.getElementById('width').value);
            const height = parseInt(document.getElementById('height').value);
            const detail = document.getElementById('detail').value;

            const standardCost = calculateStandardPricing(inputTokens, outputTokens).toFixed(6);
            const batchCost = calculateBatchPricing(inputTokens, outputTokens).toFixed(6);
            const visionCost = calculateVisionPricing(width, height, detail).toFixed(6);

            document.getElementById('standardCost').innerText = `Standard Pricing Cost: $${standardCost}`;
            document.getElementById('batchCost').innerText = `Batch API Pricing Cost: $${batchCost}`;
            document.getElementById('visionCost').innerText = `Vision Pricing Cost: $${visionCost}`;
        }
    </script>
</body>
</html>
